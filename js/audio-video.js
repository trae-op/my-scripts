(function(audioVideoPrototypes,elementPrototypes,w,d){var DataAV=[];w.AudioVideo=function(data){var _this=this;_this.All(data,function(object,index){try{if(!object.video)object.element=new Audio();else object.element=d.getElementById(object.element);DataAV.push(object);_this.Track(index,object.path)}catch(infoError){if(object.error)object.error(infoError)}})};audioVideoPrototypes(DataAV,w,d);elementPrototypes(w,d)}(function(DataAV,w,d){AudioVideo.prototype.Data=function(index){var mainObject=DataAV[index];return{dom:d,object:mainObject,controls:mainObject.controls,element:mainObject.element}};AudioVideo.prototype.All=function(array,callBack){array.forEach(callBack)};AudioVideo.prototype.Track=function(index,path){var _this=this;_this.All(path,function(dataPath,indexPath){_this.Data(index).element.src=dataPath});_this.Data(index).element.onloadeddata=function(){if(_this.Controls)_this.Controls(index);if(_this.Data(index).object.end)_this.Data(index).element.onended=_this.Data(index).object.end};if(_this.LoadProgress&&_this.Data(index).controls)_this.LoadProgress(index)};AudioVideo.prototype.LoadProgress=function(index){var _this=this;_this.Data(index).object.valueLoad=0;_this.Data(index).element.onprogress=function(){var ranges=[];for(var i=0;i<this.buffered.length;i++)ranges.push([this.buffered.start(i),this.buffered.end(i)]);var lastValue=this.duration/100;var allbufer=0;for(var i=0;i<this.buffered.length;i++)allbufer+=ranges[i][1]-ranges[i][0];var result=Math.floor(allbufer/lastValue);if(result>0){result=(result>100)?result===100:result;if(_this.Data(index).object.loadProgress)_this.Data(index).object.loadProgress(result);_this.Data(index).object.valueLoad=result}}};AudioVideo.prototype.Play=function(index){var _this=this;_this.Data(index).element.play();return _this};AudioVideo.prototype.Pause=function(index){var _this=this;_this.Data(index).element.pause();return _this};AudioVideo.prototype.Stop=function(index){var _this=this;_this.Pause(index).Progress(index,0)};AudioVideo.prototype.Progress=function(index,value){var _this=this;var checkLoadValue=(value<=_this.Data(index).object.valueLoad);if(checkLoadValue)_this.Data(index).element.currentTime=(value/100)*_this.Data(index).element.duration;if(!_this.Data(index).controls||!_this.Controls)return;if(_this.Data(index).controls.progress&&checkLoadValue)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.progress)[index].children[0].style.width=value+'%';if(_this.Data(index).controls.tagStartTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagStartTime)[index].TimeFirstLastAV(_this.Data(index).element,'first');if(_this.Data(index).controls.tagEndTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagEndTime)[index].TimeFirstLastAV(_this.Data(index).element,'last');return _this};AudioVideo.prototype.ValueProgress=function(index){var _this=this;return(_this.Data(index).element.currentTime*100)/_this.Data(index).element.duration};AudioVideo.prototype.Interval=function(index){var _this=this;if(_this.Data(index).controls.progress){var elementProgress=_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.progress)[index].children[0];_this.Data(index).element.ontimeupdate=function(){elementProgress.style.width=_this.ValueProgress(index)+'%';if(_this.Data(index).controls.tagStartTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagStartTime)[index].TimeFirstLastAV(_this.Data(index).element,'first');if(_this.Data(index).controls.tagEndTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagEndTime)[index].TimeFirstLastAV(_this.Data(index).element,'last')}}return _this};AudioVideo.prototype.Volume=function(index,value){var _this=this;var result=value/100;if(value>100)result=1;if(value<0)result=0;_this.Data(index).element.volume=result;if(!_this.Data(index).controls||!_this.Controls)return;var checkWH=(_this.Data(index).controls.verticalVolume?'height':'width');if(_this.Data(index).controls.volume)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.volume)[index].children[0].style[checkWH]=value+'%';return _this};AudioVideo.prototype.CheckMobileDevice=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|ZuneWP7/i.test(navigator.userAgent||navigator.vendor||window.opera)};AudioVideo.prototype.ClickCursor=function(event,axis){switch(axis){case'x':return event.offsetX||event.layerX;break;case'y':return event.offsetY||event.layerY;break;default:return}};AudioVideo.prototype.Controls=function(index){var _this=this;var checkEvent='';if(!_this.Data(index).controls)return;if(!_this.CheckMobileDevice())checkEvent='click';else checkEvent='touchstart';if(_this.Data(index).controls.play)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.play)[index].EventsAV(checkEvent,function(){_this.Play(index).Interval(index)});if(_this.Data(index).controls.pause)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.pause)[index].EventsAV(checkEvent,function(){_this.Pause(index)});if(_this.Data(index).controls.stop)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.stop)[index].EventsAV(checkEvent,function(){_this.Stop(index)});var valueProgressVolume=function(event,relative,axis){return((_this.ClickCursor(event,axis)/(relative))*100)};if(_this.Data(index).controls.progress){var elementProgress=_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.progress)[index];var relativeProgressStyle=parseInt(elementProgress.StyleElementAV('width'));elementProgress.NewElementAV({tag:'DIV'}).EventsAV(checkEvent,function(event){var valueAxis=valueProgressVolume(event,relativeProgressStyle,'x');_this.Progress(index,valueAxis)})}if(_this.Data(index).controls.volume){var elementVolume=_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.volume)[index];var checkWH=(_this.Data(index).controls.verticalVolume?'height':'width');var relativeVolumeStyle=parseInt(elementVolume.StyleElementAV(checkWH));elementVolume.NewElementAV({tag:'DIV'}).EventsAV(checkEvent,function(event){var valueAxis=valueProgressVolume(event,relativeVolumeStyle,(_this.Data(index).controls.verticalVolume?'y':'x'));_this.Volume(index,valueAxis)})}if(_this.Data(index).controls.valueProgress)_this.Progress(index,_this.Data(index).controls.valueProgress);if(_this.Data(index).controls.valueVolume)_this.Volume(index,_this.Data(index).controls.valueVolume);else _this.Volume(index,50);if(_this.Data(index).object.autoPlay)_this.Play(index).Interval(index);if(_this.Data(index).controls.tagStartTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagStartTime)[index].TimeFirstLastAV(_this.Data(index).element,'first');if(_this.Data(index).controls.tagEndTime)_this.Data(index).dom.getElementsByClassName(_this.Data(index).controls.tagEndTime)[index].TimeFirstLastAV(_this.Data(index).element,'last')}},function(w,d){Element.prototype.TimeFirstLastAV=function(audioVideoApi,valTime){var _this=this;var timeCounter=function(s){var a=0|s/3600;var b=0|(s-(a*3600))/60;var c=0|s-(a*3600)-(b*60);return[b,c]};if(valTime==='first'){var ms=timeCounter(audioVideoApi.currentTime);var m=ms[0];var s=ms[1];var str=(''+s).length;_this.textContent='0'+m+':'+(str===1?'0'+s:s)}if(valTime==='last'){var msThis=timeCounter(audioVideoApi.currentTime);var mThis=msThis[0];var sThis=msThis[1];var msLast=timeCounter(audioVideoApi.duration);var mLast=msLast[0];var sLast=msLast[1];var lastResMin=(mLast-mThis);var lastResSec=(sLast-sThis);var strLast=(''+lastResSec).length;var lastRes='0'+(lastResSec<0?lastResMin-1:lastResMin)+':'+(strLast===1?'0'+lastResSec:(lastResSec<0?(60+lastResSec):lastResSec));_this.textContent=lastRes}};Element.prototype.EventsAV=function(value,callBack){var _this=this;if(_this.addEventListener)_this.addEventListener(value,callBack,false);else _this.attachEvent(value,callBack);return _this};Element.prototype.NewElementAV=function(object){var _this=this;var create=d.createElement(object.tag);if(object.nameId)create.id=object.nameId+'';if(object.nameClass)create.className=object.nameClass;_this.appendChild(create);return _this};Element.prototype.StyleElementAV=function(value){var _this=this;var w=window;if(w.getComputedStyle(_this)!==undefined)return w.getComputedStyle(_this).getPropertyValue(value)}},window,document));